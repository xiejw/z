# === --- Configs generated by configure.py -------------------------------- ===
#
-include ./configure.mk

ifndef C4_CONFIGURE_DONE
$(error "Project is not configured. Run 'python configure.py' first")
endif

# === --- Configs ---------------------------------------------------------- ===
#
PY            = python3
PY_LIB_PATH   = PYTHONPATH="lib"

# === --- Actions ---------------------------------------------------------- ===
#
.PHONY: play test build_docker clean default

.DEFAULT_GOAL = play

play:
	${PY_LIB_PATH} C4_STATE_FILE=${C4_STATE_FILE} ${PY} cmd/play_with_human.py

test:
	${PY_LIB_PATH} C4_STATE_FILE=${C4_STATE_FILE} ${PY} cmd/play_santiy_check.py

# === --- Housekeeping ----------------------------------------------------- ===
#
clean:
	go run ~/Workspace/y/tools/delete_unused_dirs.go

# === --- Docker ----------------------------------------------------------- ===
#
build_docker:
	make -C misc/docker C4_STATE_FILE=${C4_STATE_FILE} build_docker

build_docker_par:
	make -C misc/docker C4_TRACED_MODEL_FILE=${C4_TRACED_MODEL_FILE} build_docker_par


# OLD NOTES:
# To create tar.gz for release
#
#   tar -czvf c4-resnet.pt.tar.gz c4-resnet-5x5.pt.state traced_resnet_model.pt

